import{b as O,c as r,d as p,e as m,f as he,g as _}from"./chunk-YJ5RMHHJ.js";var Be=!1,Ne=class{is(e){return this instanceof e}as(e){return this instanceof e?this:null}},Q=class extends Ne{constructor(){super(),Be&&Object.defineProperty(this,"_debugStr",{get:()=>this.toString()})}get log(){return console.log.bind(console,this,this.toString())}};function Qe(e,t=!0){if(!t)return e;switch(e){case 1:return-1;case-1:return 1}}function Oe(e,t){return t===-1?Array.from(e).reverse():e}function $e(e){return Array.from(e).reverse()}function*lt(e,t){t===-1?yield*Te(e):yield*e}function*Te(e){for(let t of Array.from(e).reverse())yield t}var me=2147483647,pe="2^31 - 1",Ge=-2147483648,$,Se,We=(Se=class{constructor(){p(this,$,[])}push(e){r(this,$).push(e)}experimentalPushAlg(e){for(let t of e.childAlgNodes())this.push(t)}experimentalNumAlgNodes(){return r(this,$).length}toAlg(){return new o(r(this,$))}reset(){m(this,$,[])}},$=new WeakMap,Se),Ce={caretNISSNotationEnabled:!0};function ht(e){"caretNISSNotationEnabled"in e&&(Ce.caretNISSNotationEnabled=!!e.caretNISSNotationEnabled)}var T,G,Z,M=(Z=class extends Q{constructor(n,i){super();p(this,T,void 0);p(this,G,void 0);m(this,T,te(n)),m(this,G,te(i))}get A(){return r(this,T)}get B(){return r(this,G)}isIdentical(n){let i=n.as(Z);return!!(i?.A.isIdentical(this.A)&&i?.B.isIdentical(this.B))}invert(){return new Z(r(this,G),r(this,T))}*experimentalExpand(n=1,i){i??(i=1/0),i===0?yield n===1?this:this.invert():n===1?(yield*this.A.experimentalExpand(1,i-1),yield*this.B.experimentalExpand(1,i-1),yield*this.A.experimentalExpand(-1,i-1),yield*this.B.experimentalExpand(-1,i-1)):(yield*this.B.experimentalExpand(1,i-1),yield*this.A.experimentalExpand(1,i-1),yield*this.B.experimentalExpand(-1,i-1),yield*this.A.experimentalExpand(-1,i-1))}toString(){return`[${r(this,T).toString()}, ${r(this,G).toString()}]`}},T=new WeakMap,G=new WeakMap,Z),j,K,J,b=(J=class extends Q{constructor(n,i){super();p(this,j,void 0);p(this,K,void 0);m(this,j,te(n)),m(this,K,te(i))}get A(){return r(this,j)}get B(){return r(this,K)}isIdentical(n){let i=n.as(J);return!!(i?.A.isIdentical(this.A)&&i?.B.isIdentical(this.B))}invert(){return new J(r(this,j),r(this,K).invert())}*experimentalExpand(n,i){i??(i=1/0),i===0?yield n===1?this:this.invert():(yield*this.A.experimentalExpand(1,i-1),yield*this.B.experimentalExpand(n,i-1),yield*this.A.experimentalExpand(-1,i-1))}toString(){return`[${this.A}: ${this.B}]`}},j=new WeakMap,K=new WeakMap,J),z,ne,se=(ne=class extends Q{constructor(n){super();p(this,z,void 0);if(n.includes(`
`)||n.includes("\r"))throw new Error("LineComment cannot contain newline");m(this,z,n)}get text(){return r(this,z)}isIdentical(n){let i=n;return n.is(ne)&&r(this,z)===r(i,z)}invert(){return this}*experimentalExpand(n=1,i=1/0){yield this}toString(){return`//${r(this,z)}`}},z=new WeakMap,ne),k=class Me extends Q{toString(){return`
`}isIdentical(t){return t.is(Me)}invert(){return this}*experimentalExpand(t=1,n=1/0){yield this}},U=class be extends Q{constructor(){super(...arguments);O(this,"experimentalNISSGrouping")}toString(){return"."}isIdentical(n){return n.is(be)}invert(){return this}*experimentalExpand(n=1,i=1/0){yield this}};function ue(e,t){return e?parseInt(e):t}var xe=/^(\d+)?('?)/,ke=/^[_\dA-Za-z]/,Fe=/^((([1-9]\d*)-)?([1-9]\d*))?([_A-Za-z]+)/,De=/^[^\n]*/,Xe=/^(-?\d+), ?/,He=/^(-?\d+)\)/;function Re(e){return new ge().parseAlg(e)}function je(e){return new ge().parseMove(e)}function Ke(e){return new ge().parseQuantumMove(e)}function w(e,t,n){let i=e;return i.startCharIndex=t,i.endCharIndex=n,i}function Ve(e,t){return"startCharIndex"in e&&(t.startCharIndex=e.startCharIndex),"endCharIndex"in e&&(t.endCharIndex=e.endCharIndex),t}var y,u,V,Ie,ge=(Ie=class{constructor(){p(this,y,"");p(this,u,0);p(this,V,[])}parseAlg(e){m(this,y,e),m(this,u,0);let t=this.parseAlgWithStopping([]);this.mustBeAtEndOfInput();let n=Array.from(t.childAlgNodes());if(r(this,V).length>0)for(let l of r(this,V).reverse())n.push(l);let i=new o(n),{startCharIndex:a,endCharIndex:h}=t;return w(i,a,h),i}parseMove(e){m(this,y,e),m(this,u,0);let t=this.parseMoveImpl();return this.mustBeAtEndOfInput(),t}parseQuantumMove(e){m(this,y,e),m(this,u,0);let t=this.parseQuantumMoveImpl();return this.mustBeAtEndOfInput(),t}mustBeAtEndOfInput(){if(r(this,u)!==r(this,y).length)throw new Error("parsing unexpectedly ended early")}parseAlgWithStopping(e){let t=r(this,u),n=r(this,u),i=new We,a=!1,h=l=>{if(a)throw new Error(`Unexpected character at index ${l}. Are you missing a space?`)};e:for(;r(this,u)<r(this,y).length;){let l=r(this,u);if(e.includes(r(this,y)[r(this,u)]))return w(i.toAlg(),t,n);if(this.tryConsumeNext(" ")){a=!1,i.experimentalNumAlgNodes()===0&&(t=r(this,u));continue e}else if(ke.test(r(this,y)[r(this,u)])){h(l);let I=this.parseMoveImpl();i.push(I),a=!0,n=r(this,u);continue e}else if(this.tryConsumeNext("(")){h(l);let I=this.tryRegex(Xe);if(I){let c=I[1],f=r(this,u),E=this.parseRegex(He),A=w(new s(new H("U_SQ_"),parseInt(c)),l+1,l+1+c.length),C=w(new s(new H("D_SQ_"),parseInt(E[1])),f,r(this,u)-1),D=w(new o([A,C]),l+1,r(this,u)-1);i.push(w(new R(D),l,r(this,u))),a=!0,n=r(this,u);continue e}else{let c=this.parseAlgWithStopping([")"]);this.mustConsumeNext(")");let f=this.parseAmount();i.push(w(new R(c,f),l,r(this,u))),a=!0,n=r(this,u);continue e}}else if(this.tryConsumeNext("^")){if(!Ce.caretNISSNotationEnabled)throw new Error("Alg contained a caret but caret NISS notation is not enabled.");this.mustConsumeNext("(");let I=this.parseAlgWithStopping([")"]);this.popNext();let c=new R(I,-1),f=new U;c.experimentalNISSPlaceholder=f,f.experimentalNISSGrouping=c,r(this,V).push(c),i.push(f)}else if(this.tryConsumeNext("[")){h(l);let I=this.parseAlgWithStopping([",",":"]),c=this.popNext(),f=this.parseAlgWithStopping(["]"]);this.mustConsumeNext("]");let E;switch(c){case":":{E=w(new b(I,f),l,r(this,u)),a=!0,n=r(this,u);break}case",":{E=w(new M(I,f),l,r(this,u)),a=!0,n=r(this,u);break}default:throw new Error("unexpected parsing error")}let A=r(this,u),C=this.parseAmount();if(C===1)i.push(E);else{let D=w(new o([E]),l,A),N=w(new R(D,C),l,r(this,u));i.push(N)}a=!0,n=r(this,u);continue e}else if(this.tryConsumeNext(`
`)){i.push(w(new k,l,r(this,u))),a=!1,n=r(this,u);continue e}else if(this.tryConsumeNext("/"))if(this.tryConsumeNext("/")){h(l);let[I]=this.parseRegex(De);i.push(w(new se(I),l,r(this,u))),a=!1,n=r(this,u);continue e}else{i.push(w(new s("_SLASH_"),l,r(this,u))),a=!0,n=r(this,u);continue e}else if(this.tryConsumeNext(".")){h(l),i.push(w(new U,l,r(this,u))),a=!0,n=r(this,u);continue e}else throw new Error(`Unexpected character: ${this.popNext()}`)}if(r(this,u)!==r(this,y).length)throw new Error("did not finish parsing?");if(e.length>0)throw new Error("expected stopping");return w(i.toAlg(),t,n)}parseQuantumMoveImpl(){let[,,,e,t,n]=this.parseRegex(Fe);return new H(n,ue(t,void 0),ue(e,void 0))}parseMoveImpl(){let e=r(this,u);if(this.tryConsumeNext("/"))return w(new s("_SLASH_"),e,r(this,u));let t=this.parseQuantumMoveImpl(),[n,i]=this.parseAmountAndTrackEmptyAbsAmount(),a=this.parseMoveSuffix();if(a){if(n<0)throw new Error("uh-oh");if((a==="++"||a==="--")&&n!==1)throw new Error("Pochmann ++ or -- moves cannot have an amount other than 1.");if((a==="++"||a==="--")&&!i)throw new Error("Pochmann ++ or -- moves cannot have an amount written as a number.");if((a==="+"||a==="-")&&i)throw new Error("Clock dial moves must have an amount written as a natural number followed by + or -.");a.startsWith("+")&&(t=t.modified({family:`${t.family}_${a==="+"?"PLUS":"PLUSPLUS"}_`})),a.startsWith("-")&&(t=t.modified({family:`${t.family}_${a==="-"?"PLUS":"PLUSPLUS"}_`}),n*=-1)}return w(new s(t,n),e,r(this,u))}parseMoveSuffix(){return this.tryConsumeNext("+")?this.tryConsumeNext("+")?"++":"+":this.tryConsumeNext("-")?this.tryConsumeNext("-")?"--":"-":null}parseAmountAndTrackEmptyAbsAmount(){let e=r(this,u),[,t,n]=this.parseRegex(xe);if(t?.startsWith("0")&&t!=="0")throw new Error(`Error at char index ${e}: An amount can only start with 0 if it's exactly the digit 0.`);return[ue(t,1)*(n==="'"?-1:1),!t]}parseAmount(){let e=r(this,u),[,t,n]=this.parseRegex(xe);if(t?.startsWith("0")&&t!=="0")throw new Error(`Error at char index ${e}: An amount number can only start with 0 if it's exactly the digit 0.`);return ue(t,1)*(n==="'"?-1:1)}parseRegex(e){let t=e.exec(this.remaining());if(t===null)throw new Error("internal parsing error");return m(this,u,r(this,u)+t[0].length),t}tryRegex(e){let t=e.exec(this.remaining());return t===null?null:(m(this,u,r(this,u)+t[0].length),t)}remaining(){return r(this,y).slice(r(this,u))}popNext(){let e=r(this,y)[r(this,u)];return he(this,u)._++,e}tryConsumeNext(e){return r(this,y)[r(this,u)]===e?(he(this,u)._++,!0):!1}mustConsumeNext(e){let t=this.popNext();if(t!==e)throw new Error(`expected \`${e}\` while parsing, encountered ${t}`);return t}},y=new WeakMap,u=new WeakMap,V=new WeakMap,Ie),Ae=new Set;function Ue(e){Ae.has(e)||(console.warn(e),Ae.add(e))}var fe=class{constructor(e,t=1){O(this,"quantum");O(this,"amount");if(this.quantum=e,this.amount=t,!Number.isInteger(this.amount)||this.amount<Ge||this.amount>me)throw new Error(`AlgNode amount absolute value must be a non-negative integer below ${pe}.`)}suffix(){let e="",t=Math.abs(this.amount);return t!==1&&(e+=t),this.amount<0&&(e+="'"),e}isIdentical(e){return this.quantum.isIdentical(e.quantum)&&this.amount===e.amount}*experimentalExpand(e,t){let n=Math.abs(this.amount),i=Qe(e,this.amount<0);for(let a=0;a<n;a++)yield*this.quantum.experimentalExpand(i,t)}},L,g,x,Y,H=(Y=class extends Ne{constructor(n,i,a){super();p(this,L,void 0);p(this,g,void 0);p(this,x,void 0);if(m(this,L,n),m(this,g,i??null),m(this,x,a??null),Object.freeze(this),r(this,g)!==null&&(!Number.isInteger(r(this,g))||r(this,g)<1||r(this,g)>me))throw new Error(`QuantumMove inner layer must be a positive integer below ${pe}.`);if(r(this,x)!==null&&(!Number.isInteger(r(this,x))||r(this,x)<1||r(this,x)>me))throw new Error(`QuantumMove outer layer must be a positive integer below ${pe}.`);if(r(this,x)!==null&&r(this,g)!==null&&r(this,g)<=r(this,x))throw new Error("QuantumMove outer layer must be smaller than inner layer.");if(r(this,x)!==null&&r(this,g)===null)throw new Error("QuantumMove with an outer layer must have an inner layer")}static fromString(n){return Ke(n)}modified(n){return new Y(n.family??r(this,L),n.innerLayer??r(this,g),n.outerLayer??r(this,x))}isIdentical(n){let i=n;return n.is(Y)&&r(this,L)===r(i,L)&&r(this,g)===r(i,g)&&r(this,x)===r(i,x)}get family(){return r(this,L)}get outerLayer(){return r(this,x)}get innerLayer(){return r(this,g)}experimentalExpand(){throw new Error("experimentalExpand() cannot be called on a `QuantumMove` directly.")}toString(){let n=r(this,L);return r(this,g)!==null&&(n=String(r(this,g))+n,r(this,x)!==null&&(n=`${String(r(this,x))}-${n}`)),n}},L=new WeakMap,g=new WeakMap,x=new WeakMap,Y),d,B,s=(B=class extends Q{constructor(...n){super();p(this,d,void 0);if(typeof n[0]=="string")if(n[1]??null){m(this,d,new fe(H.fromString(n[0]),n[1]));return}else return B.fromString(n[0]);m(this,d,new fe(n[0],n[1]))}isIdentical(n){let i=n.as(B);return!!i&&r(this,d).isIdentical(r(i,d))}invert(){return Ve(this,new B(r(this,d).quantum,-this.amount))}*experimentalExpand(n=1){n===1?yield this:yield this.modified({amount:-this.amount})}get quantum(){return r(this,d).quantum}modified(n){return new B(r(this,d).quantum.modified(n),n.amount??this.amount)}static fromString(n){return je(n)}get amount(){return r(this,d).amount}get type(){return Ue("deprecated: type"),"blockMove"}get family(){return r(this,d).quantum.family??void 0}get outerLayer(){return r(this,d).quantum.outerLayer??void 0}get innerLayer(){return r(this,d).quantum.innerLayer??void 0}toString(){if(this.family==="_SLASH_")return"/";if(this.family.endsWith("_PLUS_"))return r(this,d).quantum.toString().slice(0,-6)+Math.abs(this.amount)+(this.amount<0?"-":"+");if(this.family.endsWith("_PLUSPLUS_")){let n=Math.abs(this.amount);return r(this,d).quantum.toString().slice(0,-10)+(n===1?"":n)+(this.amount<0?"--":"++")}return r(this,d).quantum.toString()+r(this,d).suffix()}},d=new WeakMap,B),Ze=class{constructor(){O(this,"quantumU_SQ_",null);O(this,"quantumD_SQ_",null)}format(e){if(e.amount!==1)return null;let t=this.tuple(e);return t?`(${t.map(n=>n.amount).join(", ")})`:null}tuple(e){if(e.amount!==1)return null;this.quantumU_SQ_||(this.quantumU_SQ_=new H("U_SQ_")),this.quantumD_SQ_||(this.quantumD_SQ_=new H("D_SQ_"));let t=e.alg;if(t.experimentalNumChildAlgNodes()===2){let[n,i]=t.childAlgNodes();if(n.as(s)?.quantum.isIdentical(this.quantumU_SQ_)&&i.as(s)?.quantum.isIdentical(this.quantumD_SQ_))return[n,i]}return null}},ce=new Ze,v,oe,_e,F,R=(F=class extends Q{constructor(n,i){super();p(this,oe);p(this,v,void 0);O(this,"experimentalNISSPlaceholder");let a=te(n);m(this,v,new fe(a,i))}isIdentical(n){let i=n;return n.is(F)&&r(this,v).isIdentical(r(i,v))}get alg(){return r(this,v).quantum}get amount(){return r(this,v).amount}get experimentalRepetitionSuffix(){return r(this,v).suffix()}invert(){let n=ce.tuple(this);if(n){let[i,a]=n;return new F(new o([i.invert(),a.invert()]))}return new F(r(this,v).quantum,-r(this,v).amount)}*experimentalExpand(n=1,i){i??(i=1/0),i===0?yield n===1?this:this.invert():yield*r(this,v).experimentalExpand(n,i-1)}static fromString(){throw new Error("unimplemented")}toString(){return ce.format(this)??`${_(this,oe,_e).call(this)}${r(this,v).suffix()}`}experimentalAsSquare1Tuple(){return ce.tuple(this)}},v=new WeakMap,oe=new WeakSet,_e=function(){let n=r(this,v).quantum.toString(),i=this.alg.childAlgNodes(),{value:a}=i.next();return i.next().done&&(a?.is(M)||a?.is(b))?n:`(${n})`},F);function q(e,t){return e instanceof t}function Je(e){return q(e,R)||q(e,se)||q(e,M)||q(e,b)||q(e,s)||q(e,k)||q(e,U)}function qe(e,t,n){if(t.is(R))return e.traverseGrouping(t,n);if(t.is(s))return e.traverseMove(t,n);if(t.is(M))return e.traverseCommutator(t,n);if(t.is(b))return e.traverseConjugate(t,n);if(t.is(U))return e.traversePause(t,n);if(t.is(k))return e.traverseNewline(t,n);if(t.is(se))return e.traverseLineComment(t,n);throw new Error("unknown AlgNode")}function Le(e){if(e.is(R)||e.is(s)||e.is(M)||e.is(b)||e.is(U)||e.is(k)||e.is(se))return e;throw new Error("internal error: expected AlgNode")}var Pe=class{traverseAlgNode(e,t){return qe(this,e,t)}traverseIntoAlgNode(e,t){return Le(this.traverseAlgNode(e,t))}},ct=class extends Pe{traverseAlgNode(e){return qe(this,e,void 0)}traverseIntoAlgNode(e){return Le(this.traverseAlgNode(e))}};function Ye(e,t){let n=new e(...t??[]);return n.traverseAlg.bind(n)}var et="any-direction",ze=class{constructor(e={}){this.config=e}cancelQuantum(){let{cancel:e}=this.config;return e===!0?et:e===!1?"none":e?.directional??"none"}cancelAny(){return this.config.cancel&&this.cancelQuantum()!=="none"}cancelPuzzleSpecificModWrap(){let{cancel:e}=this.config;return e===!0||e===!1?"canonical-centered":e?.puzzleSpecificModWrap?e?.puzzleSpecificModWrap:e?.directional==="same-direction"?"preserve-sign":"canonical-centered"}puzzleSpecificSimplifyOptions(){return this.config.puzzleLoader?.puzzleSpecificSimplifyOptions??this.config.puzzleSpecificSimplifyOptions}};function tt(e,t){return e*Math.sign(t.amount)>=0}function nt(e,t,n=0){return((e-n)%t+t)%t+n}function rt(e,t,n){let i=new ze(n),a=Array.from(e.childAlgNodes()),h=[t];function l(){return new o([...a,...h])}function I(c){if(i.cancelPuzzleSpecificModWrap()==="none")return c;let f=i.puzzleSpecificSimplifyOptions()?.quantumMoveOrder;if(!f)return c;let E=f(t.quantum),A;switch(i.cancelPuzzleSpecificModWrap()){case"gravity":{A=-Math.floor((E-(c.amount<0?0:1))/2);break}case"canonical-centered":{A=-Math.floor((E-1)/2);break}case"canonical-positive":{A=0;break}case"preserve-sign":{A=c.amount<0?1-E:0;break}default:throw new Error("Unknown mod wrap")}let C=nt(c.amount,E,A);return c.modified({amount:C})}if(i.cancelAny()){let c,f=i.puzzleSpecificSimplifyOptions()?.axis;if(f)c=N=>f.areQuantumMovesSameAxis(t.quantum,N.quantum);else{let N=t.quantum.toString();c=X=>X.quantum.toString()===N}let E=i.cancelQuantum()==="same-direction",A=new Map;A.set(t.quantum.toString(),Math.sign(t.amount));let C;for(C=a.length-1;C>=0;C--){let N=a[C].as(s);if(!N||!c(N))break;let X=N.quantum.toString();if(E){let ae=A.get(X);if(ae&&!tt(ae,N))break;A.set(X,Math.sign(N.amount))}}let D=[...a.splice(C+1),t];if(f)h=f.simplifySameAxisMoves(D,i.cancelPuzzleSpecificModWrap()!=="none");else{let N=D.reduce((X,ae)=>X+ae.amount,0);if(A.size!==1)throw new Error("Internal error: multiple quantums when one was expected");h=[new s(t.quantum,N)]}}return h=h.map(c=>I(c)).filter(c=>c.amount!==0),l()}function it(e,t,n){let i=t.as(s);return i?rt(e,i,n):new o([...e.childAlgNodes(),t])}var le,re,we,W,ee,ie,de,Ee,st=(Ee=class extends Pe{constructor(){super(...arguments);p(this,re);p(this,W);p(this,ie);p(this,le,void 0)}*traverseAlg(t,n){if(n.depth===0){yield*t.childAlgNodes();return}let i=[],a=_(this,W,ee).call(this,n);for(let h of t.childAlgNodes())for(let l of this.traverseAlgNode(h,a))i=Array.from(it(new o(i),l,a).childAlgNodes());for(let h of i)yield h}*traverseGrouping(t,n){if(n.depth===0){yield t;return}if(t.amount===0)return;let i=new R(this.traverseAlg(t.alg,_(this,W,ee).call(this,n)),t.amount);if(i.alg.experimentalIsEmpty())return;let a=_(this,re,we).call(this).get(t);a&&(i.experimentalNISSPlaceholder=a,a.experimentalNISSGrouping=i),yield i}*traverseMove(t,n){yield t}*traverseCommutator(t,n){if(n.depth===0){yield t;return}let i=_(this,W,ee).call(this,n),a=new M(this.traverseAlg(t.A,i),this.traverseAlg(t.B,i));a.A.experimentalIsEmpty()||a.B.experimentalIsEmpty()||a.A.isIdentical(a.B)||a.A.isIdentical(a.B.invert())||_(this,ie,de).call(this,a.A,a.B,n)||(yield a)}*traverseConjugate(t,n){if(n.depth===0){yield t;return}let i=_(this,W,ee).call(this,n),a=new b(this.traverseAlg(t.A,i),this.traverseAlg(t.B,i));if(!a.B.experimentalIsEmpty()){if(a.A.experimentalIsEmpty()||a.A.isIdentical(a.B)||a.A.isIdentical(a.B.invert())||_(this,ie,de).call(this,a.A,a.B,n)){yield*t.B.childAlgNodes();return}yield a}}*traversePause(t,n){if(t.experimentalNISSGrouping){let i=new U;_(this,re,we).call(this).set(t.experimentalNISSGrouping,i),yield i}else yield t}*traverseNewline(t,n){yield t}*traverseLineComment(t,n){yield t}},le=new WeakMap,re=new WeakSet,we=function(){return r(this,le)??m(this,le,new Map)},W=new WeakSet,ee=function(t){return{...t,depth:t.depth?t.depth-1:null}},ie=new WeakSet,de=function(t,n,i){if(t.experimentalNumChildAlgNodes()===1&&n.experimentalNumChildAlgNodes()===1){let a=Array.from(t.childAlgNodes())[0]?.as(s),h=Array.from(n.childAlgNodes())[0]?.as(s);if(!(a&&h))return!1;if(h.quantum.isIdentical(a.quantum)||new ze(i).puzzleSpecificSimplifyOptions()?.axis?.areQuantumMovesSameAxis(a.quantum,h.quantum))return!0}return!1},Ee),at=Ye(st);function ye(e){if(!e)return[];if(q(e,o))return e.childAlgNodes();if(typeof e=="string")return Re(e).childAlgNodes();let t=e;if(typeof t[Symbol.iterator]=="function")return t;throw new Error("Invalid AlgNode")}function te(e){return q(e,o)?e:new o(e)}var S,P,o=(P=class extends Q{constructor(n){super();p(this,S,void 0);m(this,S,Array.from(ye(n)));for(let i of r(this,S))if(!Je(i))throw new Error("An alg can only contain alg nodes.")}isIdentical(n){let i=n;if(!n.is(P))return!1;let a=Array.from(r(this,S)),h=Array.from(r(i,S));if(a.length!==h.length)return!1;for(let l=0;l<a.length;l++)if(!a[l].isIdentical(h[l]))return!1;return!0}invert(){return new P($e(Array.from(r(this,S)).map(n=>n.invert())))}*experimentalExpand(n=1,i){i??(i=1/0);for(let a of Oe(r(this,S),n))yield*a.experimentalExpand(n,i)}expand(n){return new P(this.experimentalExpand(1,n?.depth??1/0))}*experimentalLeafMoves(){for(let n of this.experimentalExpand())n.is(s)&&(yield n)}concat(n){return new P(Array.from(r(this,S)).concat(Array.from(ye(n))))}experimentalIsEmpty(){for(let n of r(this,S))return!1;return!0}static fromString(n){return Re(n)}units(){return this.childAlgNodes()}*childAlgNodes(){for(let n of r(this,S))yield n}experimentalNumUnits(){return this.experimentalNumChildAlgNodes()}experimentalNumChildAlgNodes(){return Array.from(r(this,S)).length}get type(){return Ue("deprecated: type"),"sequence"}toString(){let n="",i=null;for(let a of r(this,S)){i&&(n+=ut(i,a));let h=a.as(U)?.experimentalNISSGrouping;if(h){if(h.amount!==-1)throw new Error("Invalid NISS Grouping amount!");n+=`^(${h.alg.toString()})`}else a.as(R)?.experimentalNISSPlaceholder||(n+=a.toString());i=a}return n}experimentalSimplify(n){return new P(at(this,n??{}))}simplify(n){return this.experimentalSimplify(n)}},S=new WeakMap,P);function ut(e,t){return e.is(k)||t.is(k)||t.as(R)?.experimentalNISSPlaceholder?"":e.is(se)&&!t.is(k)?`
`:" "}var mt={Sune:new o([new s("R",1),new s("U",1),new s("R",-1),new s("U",1),new s("R",1),new s("U",-2),new s("R",-1)]),AntiSune:new o([new s("R",1),new s("U",2),new s("R",-1),new s("U",-1),new s("R",1),new s("U",-1),new s("R",-1)]),SuneCommutator:new o([new M(new o([new s("R",1),new s("U",1),new s("R",-2)]),new o([new b(new o([new s("R",1)]),new o([new s("U",1)]))]))]),Niklas:new o([new s("R",1),new s("U",-1),new s("L",-1),new s("U",1),new s("R",-1),new s("U",-1),new s("L",1),new s("U",1)]),EPerm:new o([new s("x",-1),new M(new o([new b(new o([new s("R",1)]),new o([new s("U",-1)]))]),new o([new s("D",1)])),new M(new o([new b(new o([new s("R",1)]),new o([new s("U",1)]))]),new o([new s("D",1)])),new s("x",1)]),FURURFCompact:new o([new b(new o([new s("F",1)]),new o([new M(new o([new s("U",1)]),new o([new s("R",1)]))]))]),APermCompact:new o([new b(new o([new s("R",2)]),new o([new M(new o([new s("F",2)]),new o([new s("R",-1),new s("B",-1),new s("R",1)]))]))]),FURURFMoves:new o([new s("F",1),new s("U",1),new s("R",1),new s("U",-1),new s("R",-1),new s("F",-1)]),TPerm:new o([new s("R",1),new s("U",1),new s("R",-1),new s("U",-1),new s("R",-1),new s("F",1),new s("R",2),new s("U",-1),new s("R",-1),new s("U",-1),new s("R",1),new s("U",1),new s("R",-1),new s("F",-1)]),HeadlightSwaps:new o([new b(new o([new s("F",1)]),new o([new R(new o([new M(new o([new s("R",1)]),new o([new s("U",1)]))]),3)]))]),TriplePause:new o([new U,new U,new U])},ot={73:new s("R"),75:new s("R'"),87:new s("B"),79:new s("B'"),83:new s("D"),76:new s("D'"),68:new s("L"),69:new s("L'"),74:new s("U"),70:new s("U'"),72:new s("F"),71:new s("F'"),78:new s("x'"),67:new s("l"),82:new s("l'"),85:new s("r"),77:new s("r'"),88:new s("d"),188:new s("d'"),84:new s("x"),89:new s("x"),66:new s("x'"),186:new s("y"),59:new s("y"),65:new s("y'"),80:new s("z"),81:new s("z'"),90:new s("M'"),190:new s("M'"),192:new U};function pt(e){return e.altKey||e.ctrlKey?null:ot[e.keyCode]||null}function ve(e){let t=e.toString();return t=t.replace(/_/g,"&#95;").replace(/ /g,"_"),t=t.replace(/\+/g,"&#2b;"),t=t.replace(/-/g,"&#45;").replace(/'/g,"-"),t}function ft(e){let t=new URL("https://alg.cubing.net");if(!e.alg)throw new Error("An alg parameter is required.");if(t.searchParams.set("alg",ve(e.alg)),e.setup&&t.searchParams.set("setup",ve(e.setup)),e.title&&t.searchParams.set("title",e.title),e.puzzle){if(!["1x1x1","2x2x2","3x3x3","4x4x4","5x5x5","6x6x6","7x7x7","8x8x8","9x9x9","10x10x10","11x11x11","12x12x12","13x13x13","14x14x14","16x16x16","17x17x17"].includes(e.puzzle))throw new Error(`Invalid puzzle parameter: ${e.puzzle}`);t.searchParams.set("puzzle",e.puzzle)}if(e.stage){if(!["full","cross","F2L","LL","OLL","PLL","CLS","ELS","L6E","CMLL","WV","ZBLL","void"].includes(e.stage))throw new Error(`Invalid stage parameter: ${e.stage}`);t.searchParams.set("stage",e.stage)}if(e.view){if(!["editor","playback","fullscreen"].includes(e.view))throw new Error(`Invalid view parameter: ${e.view}`);t.searchParams.set("view",e.view)}if(e.type){if(!["moves","reconstruction","alg","reconstruction-end-with-setup"].includes(e.type))throw new Error(`Invalid type parameter: ${e.type}`);t.searchParams.set("type",e.type)}return t.toString()}export{Oe as a,lt as b,We as c,ht as d,M as e,b as f,se as g,k as h,U as i,H as j,s as k,R as l,q as m,Pe as n,ct as o,Ye as p,nt as q,rt as r,o as s,mt as t,pt as u,ft as v};
